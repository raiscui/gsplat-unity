# 说明:
# - 这是本仓库的"私有 .envrc",用于 direnv 自动加载本地环境变量.
# - 我会把它加入 `.git/info/exclude`,避免误提交到远端.
# - 你只需要在这里填好 `GITHUB_TOKEN`,就可以让本地 `git push` 走 https 非交互认证.

# ------------------------------
# 1) 代理(可选)
# ------------------------------
# 如果你不需要代理,可以把下面 6 行注释掉.
export https_proxy="${https_proxy:-http://127.0.0.1:7897}"
export http_proxy="${http_proxy:-http://127.0.0.1:7897}"
export all_proxy="${all_proxy:-socks5://127.0.0.1:7897}"
export HTTPS_PROXY="${HTTPS_PROXY:-$https_proxy}"
export HTTP_PROXY="${HTTP_PROXY:-$http_proxy}"
export ALL_PROXY="${ALL_PROXY:-$all_proxy}"

# ------------------------------
# 2) GitHub 凭据(https)
# ------------------------------
# fine-grained PAT 建议权限: Contents: Read and write.
export GITHUB_USERNAME="${GITHUB_USERNAME:-raiscui}"

# TODO: 把你的 PAT 粘贴到这里(私有文件,不会进 git).
export GITHUB_TOKEN="${GITHUB_TOKEN:-}"

# ------------------------------
# 3) Git 非交互认证(AskPass)
# ------------------------------
# 说明:
# - 之前 `git push` 失败的原因是"terminal prompts disabled"且环境里没有凭据.
# - 这里通过 `GIT_ASKPASS` 提供用户名/Token,避免 git 进入交互式提示.
export GIT_TERMINAL_PROMPT=0
export GIT_ASKPASS="$PWD/.direnv/git-askpass.sh"

# ------------------------------
# 4) uv 下载超时(可选)
# ------------------------------
export UV_HTTP_TIMEOUT="${UV_HTTP_TIMEOUT:-600}"

if [ -f ".envrc.private" ]; then
  source_env ".envrc.private"
fi